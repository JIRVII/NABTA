{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/%D9%8A%D8%A7%D9%85%D9%8A%D9%83%D8%B3/Documents/GitHub/NABTA/nabta/src/app/api/plantai/route.js"],"sourcesContent":["// src/app/plantai/route.js\r\nimport { GoogleGenAI } from '@google/genai';\r\nimport { NextResponse } from 'next/server';\r\n\r\n// ⬅️ 1. تأكد من تهيئة المفتاح بشكل صحيح\r\nconst ai = new GoogleGenAI({\r\n  apiKey: process.env.GEMINI_API_KEY || process.env.GOOGLE_API_KEY, \r\n});\r\n\r\n// ⬅️ 2. تحديد دور النموذج (System Instruction)\r\nconst SYSTEM_INSTRUCTION = \"أنت خبير نباتات ذكي ومفيد جداً. مهمتك هي الإجابة على أسئلة المستخدمين حول العناية بالنباتات، تشخيص الأمراض النباتية، وتقديم نصائح لزراعة صحية. ردودك يجب أن تكون دقيقة وودودة.\";\r\n\r\n\r\nexport async function POST(request) {\r\n  try {\r\n    const { message } = await request.json();\r\n\r\n    // ⬅️ 3. إنشاء جلسة دردشة وإضافة التوجيهات\r\n    const chat = ai.chats.create({\r\n      model: \"gemini-2.5-flash\", // يمكنك استخدام gemini-2.5-flash لسرعة الرد\r\n      config: {\r\n        systemInstruction: SYSTEM_INSTRUCTION, // إضافة دور الخبير هنا\r\n      },\r\n      // إذا كنت تريد الحفاظ على سياق الدردشة الطويل، أضف السجل هنا.\r\n      // لكن حاليًا، نركز على الرد على رسالة واحدة.\r\n    });\r\n\r\n    const response = await chat.sendMessage({ message });\r\n    \r\n    // تأكد من أن الرد يتم استخراجه بشكل صحيح\r\n    const reply = response.text;\r\n\r\n    return NextResponse.json({ reply });\r\n  } catch (error) {\r\n    console.error('Gemini API Error:', error);\r\n    // إرسال رسالة خطأ واضحة\r\n    return NextResponse.json({ error: 'حدث خطأ أثناء الاتصال بخبير النبات. (تحقق من مفتاح API)' }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":"AAAA,2BAA2B;;;;;AAC3B;AACA;;;AAEA,wCAAwC;AACxC,MAAM,KAAK,IAAI,qNAAW,CAAC;IACzB,QAAQ,QAAQ,GAAG,CAAC,cAAc,IAAI,QAAQ,GAAG,CAAC,cAAc;AAClE;AAEA,+CAA+C;AAC/C,MAAM,qBAAqB;AAGpB,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEtC,0CAA0C;QAC1C,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC;YAC3B,OAAO;YACP,QAAQ;gBACN,mBAAmB;YACrB;QAGF;QAEA,MAAM,WAAW,MAAM,KAAK,WAAW,CAAC;YAAE;QAAQ;QAElD,yCAAyC;QACzC,MAAM,QAAQ,SAAS,IAAI;QAE3B,OAAO,yLAAY,CAAC,IAAI,CAAC;YAAE;QAAM;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,wBAAwB;QACxB,OAAO,yLAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA0D,GAAG;YAAE,QAAQ;QAAI;IAC/G;AACF","debugId":null}}]
}